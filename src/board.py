from src.player import Player
from src.bomb import Bomb
import numpy as np


class Board:
    def __init__(self, data):
        map_info = data["map_info"]
        self.cols = map_info["size"]["cols"]
        self.rows = map_info["size"]["rows"]
        self.players = self.transform_class(map_info["players"], Player)
        self.map = np.array(map_info["map"])
        self.bombs = self.transform_class(map_info["bombs"], Bomb)
        self.tag_name = data["tag"]

    @staticmethod
    def transform_class(data, cls):
        results = [cls(item) for item in data]
        return results

    def get_player(self, player_id):
        player = [p for p in self.players if p.id == player_id]
        return player[0] if player else None

data = {
   "map_info":{
      "myId":"",
      "size":{
         "cols":28,
         "rows":18
      },
      "players":[
         {
            "id":"player1-xxx-xxx-xxx",
            "currentPosition":{
               "col":22,
               "row":3
            },
            "spawnBegin":{
               "col":22,
               "row":3
            },
            "spaceStone":0,
            "mindStone":0,
            "realityStone":0,
            "powerStone":0,
            "timeStone":0,
            "soulStone":0
         },
         {
            "id":"player2-xxx-xxx-xxx",
            "currentPosition":{
               "col":6,
               "row":4
            },
            "spawnBegin":{
               "col":6,
               "row":4
            },
            "spaceStone":0,
            "mindStone":0,
            "realityStone":0,
            "powerStone":0,
            "timeStone":0,
            "soulStone":0
         }
      ],
      "map":[
         [
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1
         ],
         [
            1,
            0,
            2,
            1,
            0,
            0,
            2,
            0,
            0,
            2,
            0,
            2,
            2,
            0,
            2,
            0,
            2,
            0,
            0,
            0,
            0,
            2,
            0,
            1,
            0,
            2,
            0,
            1
         ],
         [
            1,
            0,
            0,
            2,
            0,
            2,
            2,
            2,
            0,
            0,
            2,
            1,
            0,
            2,
            0,
            2,
            0,
            1,
            2,
            2,
            0,
            2,
            2,
            0,
            2,
            0,
            0,
            1
         ],
         [
            1,
            1,
            0,
            0,
            2,
            0,
            2,
            1,
            2,
            0,
            0,
            1,
            1,
            1,
            0,
            0,
            1,
            1,
            0,
            0,
            1,
            0,
            0,
            2,
            0,
            0,
            1,
            1
         ],
         [
            1,
            2,
            1,
            2,
            0,
            0,
            0,
            2,
            1,
            2,
            0,
            0,
            2,
            2,
            0,
            0,
            2,
            0,
            0,
            1,
            0,
            0,
            0,
            0,
            0,
            1,
            2,
            1
         ],
         [
            1,
            0,
            2,
            2,
            2,
            1,
            0,
            0,
            2,
            1,
            2,
            0,
            0,
            0,
            0,
            1,
            0,
            0,
            1,
            2,
            2,
            2,
            1,
            2,
            1,
            2,
            0,
            1
         ],
         [
            1,
            0,
            0,
            2,
            1,
            0,
            2,
            0,
            0,
            0,
            0,
            2,
            0,
            2,
            1,
            1,
            0,
            2,
            0,
            0,
            2,
            0,
            0,
            1,
            2,
            0,
            0,
            1
         ],
         [
            1,
            0,
            2,
            0,
            2,
            0,
            0,
            1,
            2,
            0,
            1,
            2,
            2,
            2,
            0,
            0,
            0,
            2,
            2,
            2,
            0,
            2,
            0,
            0,
            0,
            2,
            0,
            1
         ],
         [
            1,
            0,
            0,
            0,
            0,
            2,
            0,
            1,
            2,
            0,
            1,
            1,
            1,
            0,
            0,
            2,
            0,
            0,
            0,
            2,
            1,
            0,
            2,
            0,
            2,
            1,
            1,
            1
         ],
         [
            1,
            0,
            1,
            1,
            2,
            0,
            0,
            1,
            2,
            0,
            2,
            2,
            0,
            2,
            2,
            1,
            1,
            1,
            0,
            0,
            1,
            2,
            0,
            2,
            0,
            0,
            0,
            1
         ],
         [
            1,
            0,
            0,
            0,
            0,
            2,
            0,
            2,
            2,
            0,
            0,
            0,
            0,
            0,
            2,
            1,
            2,
            0,
            2,
            0,
            1,
            0,
            0,
            2,
            0,
            2,
            0,
            1
         ],
         [
            1,
            0,
            2,
            2,
            1,
            0,
            0,
            0,
            0,
            2,
            0,
            1,
            1,
            0,
            0,
            0,
            2,
            0,
            2,
            0,
            2,
            2,
            2,
            1,
            2,
            0,
            2,
            1
         ],
         [
            1,
            0,
            2,
            1,
            2,
            1,
            2,
            0,
            0,
            1,
            2,
            2,
            1,
            0,
            2,
            0,
            0,
            0,
            1,
            0,
            0,
            0,
            1,
            2,
            1,
            2,
            0,
            1
         ],
         [
            1,
            2,
            1,
            0,
            2,
            0,
            2,
            0,
            1,
            0,
            0,
            0,
            0,
            0,
            2,
            0,
            0,
            0,
            0,
            1,
            0,
            0,
            2,
            0,
            2,
            1,
            2,
            1
         ],
         [
            1,
            1,
            0,
            0,
            0,
            0,
            0,
            1,
            0,
            0,
            1,
            1,
            1,
            0,
            0,
            1,
            1,
            0,
            2,
            0,
            1,
            0,
            2,
            0,
            0,
            2,
            1,
            1
         ],
         [
            1,
            0,
            0,
            2,
            2,
            2,
            0,
            0,
            2,
            2,
            1,
            0,
            2,
            2,
            2,
            2,
            1,
            2,
            0,
            2,
            0,
            2,
            0,
            0,
            0,
            0,
            0,
            1
         ],
         [
            1,
            0,
            0,
            2,
            1,
            2,
            0,
            0,
            0,
            0,
            2,
            2,
            0,
            0,
            0,
            0,
            2,
            2,
            0,
            0,
            0,
            0,
            0,
            1,
            2,
            0,
            0,
            1
         ],
         [
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1
         ]
      ],
      "bombs":[

      ],
      "spoils":[

      ],
      "gameStatus":None
   },
   "tag":"start-game"
}

BOARD = Board(data)
print(BOARD.players)